from flask import Flask, request, jsonify
import openai
import os

app = Flask(__name__)

# Вставляем свой API-ключ OpenAI
openai.api_key = ""

@app.route('/webhook', methods=['POST'])
def webhook():
    data = request.json
    user_text = data['request']['original_utterance']

    gpt_response = openai.ChatCompletion.create(
        model="gpt-3.5-turbo",
        messages=[{"role": "user", "content": user_text}]
    )

    answer = gpt_response['choices'][0]['message']['content']

    response = {
        "response": {
            "text": answer,
            "end_session": False
        },
        "version": data['version']
    }
    return jsonify(response)

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000)
